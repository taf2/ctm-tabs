<html>
<head>
<script src="tabs.js"></script>
</head>
<body>
  <h3>Tabs Open</h3>
  <div id="tab-details">Loading...</div>
  <script>
    addEventListener('DOMContentLoaded', (event) => {
      const params = new URLSearchParams(window.location.search);
      window.tabs = new Tabs("tabs-demo", {canLeader: !params.get("notLeader")});

      window.tabs.on("update", (dirty, tabs) => {
        const outputTabs = [];
        for (const tab of tabs.entries()) {
          outputTabs.push(`<tr><td>${tab[0]}</td><td>${JSON.stringify(tab[1])}</td></tr>`);
        }
        document.getElementById("tab-details").innerHTML = `<p>Open Tabs: ${this.tabs.size}</p>
                  <table><tr><th>ID</th><th>Attributes</th></tr>${outputTabs.join('')}</table>`;
      });

      window.tabs.start();
    });
  </script>
</body>
</html>
